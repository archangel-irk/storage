<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
	<title>storage.js</title>
	<script src="node_modules/lodash/dist/lodash.js"></script>

	<script src="dist/storage.min.debug.js"></script>
</head>
<body>

<div id="elem"></div>

<script>
var User = new Schema('User', {
  userId: {
    type: String,
    required: true
  },
  clientId: {
    type: String,
    required: true
  },
  token: {
    type: String,
    unique: true,
    required: true
  },
  created: {
    type: Date,
    default: Date.now
  },
  wifi: Boolean,

  children: [ Number ]
},{
  strict: false
});

storage.createCollection('users', User );

var doc = storage.users.add({
    userId: 'e45345',
    fuck: 'fuck',
    wifi: true,
    children: [1,2,3,4,5]
});


var id = doc.id;

doc.getChildren = function(){
    return storage.users.findById( id ).children;
};

var doc2 = new storage.Document( new Schema('Tree', {
  rootNodes: []
}));

doc2.getChildren = function( param ){
    return _.filter( storage.users.findById( id ).children, function ( num ) {
        return num % param == 0;
    });
};

/*doc.getSubtotal = function() {
    return "$" + this.userId + this.clientId;
};*/

console.log( doc2.rootNodes );
doc2.rootNodes = doc2.getChildren( 1 );
console.log( doc2.rootNodes );

//----------------------------------------------

/*storage.createCollection('amsterdam');

var doc = storage.amsterdam.add({
    id: 0,
    price: 10,
    quantity: 5,
    getSubtotal: function() {
        return "$" + (this.price * this.quantity).toFixed(2);
    }
});*/
</script>
</body>
</html>